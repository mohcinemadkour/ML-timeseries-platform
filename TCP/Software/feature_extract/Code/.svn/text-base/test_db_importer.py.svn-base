#!/usr/bin/env python
"""
   v0.1 Script used for testing db_importer.py
       - useful for refactoring, or adding new xml read/write methods, updating internal structures.

# REQUIRE:
  - additional timeseries columns

# TEST:
  - using inmem structure, write new-xml file
     - read old xml file, or string & write new xml
         - this will just have basic t,m,merr elements
     - allow in-mem structure to contain additional timeseries params, write xml
     - write classification info, when present in old-xml & thus in-mem structure
  - read new-xml file, store in in-mem structure, successfully generate features
     - read new-xml file, or string.
     - read some xml exmaples from Dotastro webpage
          - then test writing these in-mem as new-xmls.
  - (check) read old xml, store in internal structure, successfully generate features
     - read old xml file, or string.
  - ? Can I parse some of Johns Dotastro.org examples?

"""

import os, sys
import pprint

import db_importer



""" # EXAMPLE ENTRY:
                      {'xml_fpath':"$TCP_DIR/Data/vosource_9026.xml",
                       'expected_xsdict':{}},
"""
pars = {'test_cases':[{'xml_fpath':"$TCP_DIR/Data/vosource_9026.xml",
                       'expected_xsdict':{'src_id': 9026, 'ra': 187.27791540000001, 'dec': 2.0523883000000001, 'dec_rms': 0.0, 'class': '', 'ra_rms': 0.0, 'ts': {'combo_band': {'ucds': ['time.epoch', 'phot.mag;V', 'stat.error;phot.mag;V'], 'm_err': [0.01, 0.012, 0.012999999999999999, 0.012, 0.014999999999999999, 0.0089999999999999993, 0.016, 0.0089999999999999993, 0.017999999999999999, 0.016, 0.014999999999999999, 0.01, 0.014999999999999999, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.014, 0.024, 0.0089999999999999993, 0.0089999999999999993, 0.010999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.01, 0.010999999999999999, 0.0070000000000000001, 0.0080000000000000002, 0.0089999999999999993, 0.012, 0.0080000000000000002, 0.0089999999999999993, 0.010999999999999999, 0.012999999999999999, 0.01, 0.010999999999999999, 0.012, 0.01, 0.012, 0.010999999999999999, 0.012, 0.012999999999999999, 0.023, 0.012, 0.012, 0.017999999999999999, 0.0080000000000000002, 0.0089999999999999993, 0.01, 0.012, 0.01, 0.01, 0.01, 0.012, 0.012, 0.012, 0.010999999999999999, 0.01, 0.012, 0.01, 0.01, 0.010999999999999999, 0.012, 0.01, 0.012, 0.012, 0.01, 0.010999999999999999, 0.0089999999999999993, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.01, 0.0080000000000000002, 0.010999999999999999, 0.012, 0.010999999999999999, 0.01, 0.0089999999999999993, 0.0060000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.012, 0.01, 0.01, 0.012, 0.012, 0.012, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0070000000000000001, 0.0089999999999999993, 0.010999999999999999, 0.012, 0.01, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.0080000000000000002, 0.01, 0.0089999999999999993, 0.012, 0.01, 0.01, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0070000000000000001, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0070000000000000001, 0.0080000000000000002, 0.012, 0.0089999999999999993, 0.0089999999999999993, 0.012999999999999999, 0.012, 0.010999999999999999, 0.012, 0.012999999999999999, 0.010999999999999999, 0.01, 0.0089999999999999993, 0.010999999999999999, 0.01, 0.01, 0.0089999999999999993, 0.01, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.012, 0.010999999999999999, 0.014, 0.012, 0.014, 0.012, 0.014, 0.012, 0.012999999999999999, 0.012999999999999999, 0.012, 0.014999999999999999, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.01, 0.01, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0080000000000000002, 0.0080000000000000002, 0.0050000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0080000000000000002, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0070000000000000001, 0.0080000000000000002, 0.01, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.012, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.012999999999999999, 0.01, 0.0080000000000000002, 0.01, 0.010999999999999999, 0.01], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [18.228000000000002, 18.262, 18.209, 18.216999999999999, 18.178999999999998, 18.204999999999998, 18.248000000000001, 18.285, 18.242000000000001, 18.238, 18.294, 18.276, 18.273, 18.288, 18.292999999999999, 18.288, 18.308, 18.286999999999999, 18.263000000000002, 18.259, 18.251999999999999, 18.280999999999999, 18.260000000000002, 18.27, 18.263999999999999, 18.286000000000001, 18.282, 18.280000000000001, 18.280000000000001, 18.291, 18.283999999999999, 18.242000000000001, 18.207999999999998, 18.210000000000001, 18.216999999999999, 18.138000000000002, 18.280000000000001, 18.236999999999998, 18.213000000000001, 18.218, 18.212, 18.218, 18.263999999999999, 18.216999999999999, 18.222999999999999, 18.248999999999999, 18.236999999999998, 18.276, 18.178000000000001, 18.202999999999999, 18.221, 18.163, 18.132999999999999, 18.135999999999999, 18.149999999999999, 18.187000000000001, 18.175000000000001, 18.209, 18.224, 18.222000000000001, 18.260999999999999, 18.257999999999999, 18.227, 18.202000000000002, 18.117999999999999, 18.175000000000001, 18.167999999999999, 18.204000000000001, 18.225999999999999, 18.213000000000001, 18.216999999999999, 18.247, 18.23, 18.163, 18.219000000000001, 18.215, 18.273, 18.280000000000001, 18.295000000000002, 18.292000000000002, 18.285, 18.295000000000002, 18.297000000000001, 18.292999999999999, 18.292000000000002, 18.289999999999999, 18.283000000000001, 18.295000000000002, 18.291, 18.277999999999999, 18.286999999999999, 18.271000000000001, 18.279, 18.265000000000001, 18.268000000000001, 18.253, 18.260999999999999, 18.225000000000001, 18.262, 18.277999999999999, 18.276, 18.274000000000001, 18.274000000000001, 18.251999999999999, 18.238, 18.227, 18.219000000000001, 18.225999999999999, 18.239000000000001, 18.244, 18.283999999999999, 18.27, 18.216000000000001, 18.178000000000001, 18.128, 18.141999999999999, 18.158000000000001, 18.117999999999999, 18.198, 18.204999999999998, 18.285, 18.274000000000001, 18.276, 18.154, 18.248999999999999, 18.263999999999999, 18.271999999999998, 18.282, 18.262, 18.239000000000001, 18.236999999999998, 18.234999999999999, 18.216999999999999, 18.218, 18.253, 18.253, 18.228999999999999, 18.259, 18.251000000000001, 18.25, 18.238, 18.245999999999999, 18.241, 18.239999999999998, 18.244, 18.262, 18.248999999999999, 18.184999999999999, 18.210000000000001, 18.196000000000002, 18.213000000000001, 18.207999999999998, 18.170999999999999, 18.155999999999999, 18.199999999999999, 18.195, 18.201000000000001, 18.204999999999998, 18.210000000000001, 18.189, 18.198, 18.218, 18.186, 18.154, 18.161999999999999, 18.175999999999998, 18.120999999999999, 18.169, 18.164000000000001, 18.187999999999999, 18.158999999999999, 18.166, 18.210000000000001, 18.210999999999999, 18.158000000000001, 18.181999999999999, 18.199999999999999, 18.236000000000001, 18.158999999999999, 18.218, 18.187999999999999, 18.209, 18.177, 18.196999999999999, 18.25, 18.241, 18.242999999999999, 18.289000000000001, 18.292000000000002, 18.286000000000001, 18.286000000000001, 18.294, 18.292000000000002, 18.279, 18.295000000000002, 18.282, 18.297999999999998, 18.295999999999999, 18.292999999999999, 18.268999999999998, 18.282, 18.302, 18.292000000000002, 18.292999999999999, 18.292999999999999, 18.292999999999999, 18.289000000000001, 18.288, 18.280999999999999, 18.292999999999999, 18.288, 18.283000000000001, 18.295000000000002, 18.298999999999999, 18.292000000000002, 18.295000000000002, 18.285, 18.280999999999999, 18.274000000000001, 18.277000000000001, 18.286000000000001, 18.280999999999999, 18.280999999999999, 18.271999999999998, 18.265999999999998, 18.271999999999998, 18.27, 18.280999999999999, 18.277000000000001, 18.279, 18.273, 18.274000000000001, 18.285, 18.257999999999999, 18.245000000000001, 18.225999999999999, 18.262, 18.204000000000001, 18.263000000000002, 18.268999999999998, 18.190999999999999, 18.244, 18.274999999999999, 18.266999999999999, 18.222000000000001, 18.256], 'IDs': ['col1', 'col2', 'col3'], 'limitmags': {'lmt_mg': [], 't': []}, 't': [2452459.8185729999, 2452459.8306928999, 2452459.8427537, 2452459.8544839998, 2452459.8662323998, 2452459.8781472002, 2452459.8905604999, 2452459.9265550999, 2452459.9396608002, 2452459.9516302999, 2452459.9678898002, 2452460.8359277998, 2452460.8477614, 2452460.8590332, 2452460.8703704001, 2452460.8797658002, 2452460.8860125998, 2452460.8917079, 2452460.8995465999, 2452460.9050044999, 2452460.9105374999, 2452460.9163111001, 2452460.9222672, 2452460.9278273, 2452460.9348979001, 2452460.9403670998, 2452460.9458375, 2452460.9512713999, 2452460.9602051, 2452460.9680122002, 2452460.9772978001, 2452460.9963249001, 2452461.0041336999, 2452461.0139990998, 2452461.0205548001, 2452461.0263260999, 2452461.9460944999, 2452461.9544901, 2452461.9657820002, 2452461.9771384001, 2452462.0229802001, 2452462.0342620001, 2452462.0464984002, 2452462.0577341001, 2452462.0710685998, 2452462.7607836002, 2452462.7688618, 2452462.7769002998, 2452462.7858614, 2452462.7946760999, 2452462.8035118999, 2452462.8123579999, 2452462.8214123002, 2452462.8306542998, 2452462.8394995001, 2452462.8483488001, 2452462.8572032, 2452462.8660523999, 2452462.8749082, 2452462.8823346002, 2452462.8909723, 2452462.8986641001, 2452462.9063515002, 2452462.9140376998, 2452462.9217332001, 2452462.9311672999, 2452462.9404271999, 2452462.9517728998, 2452462.9629454999, 2452462.9741060999, 2452462.985289, 2452462.9995295, 2452463.0106823002, 2452463.0311850002, 2452463.0423504999, 2452463.0535200001, 2452463.0646822001, 2452463.0758628999, 2452463.8809282002, 2452463.8874500999, 2452463.8939705002, 2452463.9005070999, 2452463.9076045998, 2452463.9169577998, 2452463.9235367998, 2452463.930067, 2452463.9366052002, 2452463.9431272, 2452463.9496708, 2452463.9551916001, 2452463.9602402998, 2452463.9663979001, 2452463.9775524, 2452463.9887224999, 2452463.9998951, 2452464.011163, 2452464.0223873998, 2452464.0421890002, 2452464.0533674001, 2452464.0645380002, 2452464.0756991999, 2452464.0870150002, 2452464.0988989999, 2452464.7691935999, 2452464.7749973, 2452464.7831241, 2452464.7909835, 2452464.8000174998, 2452464.8076944002, 2452464.8153761998, 2452464.8230610001, 2452464.8307369002, 2452464.8386871, 2452464.8452079999, 2452464.8517354, 2452464.8582680998, 2452464.8655905002, 2452464.8767594001, 2452464.8879149002, 2452464.8995468002, 2452464.9130450999, 2452464.9231516002, 2452464.9296871, 2452464.9362169001, 2452464.9427677002, 2452464.9493045001, 2452464.9561382001, 2452464.9626708999, 2452464.9696414, 2452464.9756021001, 2452464.981557, 2452464.9875154002, 2452464.9934634999, 2452464.9994254, 2452465.0054914001, 2452465.0140225999, 2452465.0217162999, 2452465.0294037, 2452465.037087, 2452465.0447783, 2452465.0524713001, 2452465.0601661, 2452465.0681055002, 2452465.0758051001, 2452465.0835020002, 2452465.0911890999, 2452465.0988873001, 2452465.1065902999, 2452465.1151891998, 2452467.7593765999, 2452467.7668599999, 2452467.7762775002, 2452467.7855707998, 2452467.8086043, 2452467.8169767, 2452467.825799, 2452467.8346365001, 2452467.8434843002, 2452467.8523328002, 2452467.8618055, 2452467.8708151998, 2452467.8796521001, 2452467.8884855001, 2452467.8973221001, 2452467.9061568002, 2452467.9149984, 2452467.9418004998, 2452467.9506409001, 2452467.9704935998, 2452467.9904594002, 2452468.0012963, 2452468.0105833998, 2452468.0194202, 2452468.0282562999, 2452468.0375349, 2452468.0452104001, 2452468.0528988, 2452468.0605712999, 2452468.0682568001, 2452468.0759379002, 2452468.0836236998, 2452468.0913022002, 2452468.0989836999, 2452468.1067774999, 2452468.7639945, 2452468.7691489002, 2452468.7759491, 2452468.7836175999, 2452468.7912977999, 2452468.7973225, 2452468.8032638002, 2452468.8092083, 2452468.8151540998, 2452468.8215724002, 2452468.8269324, 2452468.8322859001, 2452468.8378158999, 2452468.847902, 2452468.8532652999, 2452468.8586452999, 2452468.8639948, 2452468.8693388999, 2452468.8747039, 2452468.8790183002, 2452468.8841531002, 2452468.889523, 2452468.8948754999, 2452468.9002418998, 2452468.9056131002, 2452468.9109888002, 2452468.9167252001, 2452468.9216781999, 2452468.9264699998, 2452468.9314191998, 2452468.9405119, 2452468.9446566999, 2452468.9518300998, 2452468.9554325999, 2452468.9590640999, 2452468.9626623001, 2452468.9668753999, 2452468.9716631998, 2452468.9764532, 2452468.9812404001, 2452468.9863103, 2452468.9912828999, 2452468.9960808, 2452469.0020086002, 2452469.0067834002, 2452469.0115621001, 2452469.0175521998, 2452469.0223194002, 2452469.0271128998, 2452469.0375691, 2452469.0413084002, 2452469.0465068999, 2452469.0530118998, 2452469.0595268002, 2452469.0660430999, 2452469.0725619998, 2452469.0795280999, 2452469.0860398998, 2452469.0925564999, 2452469.0997084999, 2452469.1062276, 2452469.1127443998], 'units': ['day', 'mag', 'mag']}, 'V': {'ucds': ['time.epoch', 'phot.mag;V', 'stat.error;phot.mag;V'], 'm_err': [0.01, 0.012, 0.012999999999999999, 0.012, 0.014999999999999999, 0.0089999999999999993, 0.016, 0.0089999999999999993, 0.017999999999999999, 0.016, 0.014999999999999999, 0.01, 0.014999999999999999, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.014, 0.024, 0.0089999999999999993, 0.0089999999999999993, 0.010999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.01, 0.010999999999999999, 0.0070000000000000001, 0.0080000000000000002, 0.0089999999999999993, 0.012, 0.0080000000000000002, 0.0089999999999999993, 0.010999999999999999, 0.012999999999999999, 0.01, 0.010999999999999999, 0.012, 0.01, 0.012, 0.010999999999999999, 0.012, 0.012999999999999999, 0.023, 0.012, 0.012, 0.017999999999999999, 0.0080000000000000002, 0.0089999999999999993, 0.01, 0.012, 0.01, 0.01, 0.01, 0.012, 0.012, 0.012, 0.010999999999999999, 0.01, 0.012, 0.01, 0.01, 0.010999999999999999, 0.012, 0.01, 0.012, 0.012, 0.01, 0.010999999999999999, 0.0089999999999999993, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.01, 0.0080000000000000002, 0.010999999999999999, 0.012, 0.010999999999999999, 0.01, 0.0089999999999999993, 0.0060000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.012, 0.01, 0.01, 0.012, 0.012, 0.012, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0070000000000000001, 0.0089999999999999993, 0.010999999999999999, 0.012, 0.01, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.0080000000000000002, 0.01, 0.0089999999999999993, 0.012, 0.01, 0.01, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0089999999999999993, 0.0070000000000000001, 0.0089999999999999993, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0080000000000000002, 0.0070000000000000001, 0.0080000000000000002, 0.012, 0.0089999999999999993, 0.0089999999999999993, 0.012999999999999999, 0.012, 0.010999999999999999, 0.012, 0.012999999999999999, 0.010999999999999999, 0.01, 0.0089999999999999993, 0.010999999999999999, 0.01, 0.01, 0.0089999999999999993, 0.01, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.012, 0.010999999999999999, 0.014, 0.012, 0.014, 0.012, 0.014, 0.012, 0.012999999999999999, 0.012999999999999999, 0.012, 0.014999999999999999, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.01, 0.01, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0080000000000000002, 0.0080000000000000002, 0.0050000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0080000000000000002, 0.0060000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0070000000000000001, 0.0060000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0050000000000000001, 0.0070000000000000001, 0.0080000000000000002, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0070000000000000001, 0.0080000000000000002, 0.01, 0.01, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.0089999999999999993, 0.0089999999999999993, 0.0070000000000000001, 0.012, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.012999999999999999, 0.010999999999999999, 0.0089999999999999993, 0.012999999999999999, 0.01, 0.0080000000000000002, 0.01, 0.010999999999999999, 0.01], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [18.228000000000002, 18.262, 18.209, 18.216999999999999, 18.178999999999998, 18.204999999999998, 18.248000000000001, 18.285, 18.242000000000001, 18.238, 18.294, 18.276, 18.273, 18.288, 18.292999999999999, 18.288, 18.308, 18.286999999999999, 18.263000000000002, 18.259, 18.251999999999999, 18.280999999999999, 18.260000000000002, 18.27, 18.263999999999999, 18.286000000000001, 18.282, 18.280000000000001, 18.280000000000001, 18.291, 18.283999999999999, 18.242000000000001, 18.207999999999998, 18.210000000000001, 18.216999999999999, 18.138000000000002, 18.280000000000001, 18.236999999999998, 18.213000000000001, 18.218, 18.212, 18.218, 18.263999999999999, 18.216999999999999, 18.222999999999999, 18.248999999999999, 18.236999999999998, 18.276, 18.178000000000001, 18.202999999999999, 18.221, 18.163, 18.132999999999999, 18.135999999999999, 18.149999999999999, 18.187000000000001, 18.175000000000001, 18.209, 18.224, 18.222000000000001, 18.260999999999999, 18.257999999999999, 18.227, 18.202000000000002, 18.117999999999999, 18.175000000000001, 18.167999999999999, 18.204000000000001, 18.225999999999999, 18.213000000000001, 18.216999999999999, 18.247, 18.23, 18.163, 18.219000000000001, 18.215, 18.273, 18.280000000000001, 18.295000000000002, 18.292000000000002, 18.285, 18.295000000000002, 18.297000000000001, 18.292999999999999, 18.292000000000002, 18.289999999999999, 18.283000000000001, 18.295000000000002, 18.291, 18.277999999999999, 18.286999999999999, 18.271000000000001, 18.279, 18.265000000000001, 18.268000000000001, 18.253, 18.260999999999999, 18.225000000000001, 18.262, 18.277999999999999, 18.276, 18.274000000000001, 18.274000000000001, 18.251999999999999, 18.238, 18.227, 18.219000000000001, 18.225999999999999, 18.239000000000001, 18.244, 18.283999999999999, 18.27, 18.216000000000001, 18.178000000000001, 18.128, 18.141999999999999, 18.158000000000001, 18.117999999999999, 18.198, 18.204999999999998, 18.285, 18.274000000000001, 18.276, 18.154, 18.248999999999999, 18.263999999999999, 18.271999999999998, 18.282, 18.262, 18.239000000000001, 18.236999999999998, 18.234999999999999, 18.216999999999999, 18.218, 18.253, 18.253, 18.228999999999999, 18.259, 18.251000000000001, 18.25, 18.238, 18.245999999999999, 18.241, 18.239999999999998, 18.244, 18.262, 18.248999999999999, 18.184999999999999, 18.210000000000001, 18.196000000000002, 18.213000000000001, 18.207999999999998, 18.170999999999999, 18.155999999999999, 18.199999999999999, 18.195, 18.201000000000001, 18.204999999999998, 18.210000000000001, 18.189, 18.198, 18.218, 18.186, 18.154, 18.161999999999999, 18.175999999999998, 18.120999999999999, 18.169, 18.164000000000001, 18.187999999999999, 18.158999999999999, 18.166, 18.210000000000001, 18.210999999999999, 18.158000000000001, 18.181999999999999, 18.199999999999999, 18.236000000000001, 18.158999999999999, 18.218, 18.187999999999999, 18.209, 18.177, 18.196999999999999, 18.25, 18.241, 18.242999999999999, 18.289000000000001, 18.292000000000002, 18.286000000000001, 18.286000000000001, 18.294, 18.292000000000002, 18.279, 18.295000000000002, 18.282, 18.297999999999998, 18.295999999999999, 18.292999999999999, 18.268999999999998, 18.282, 18.302, 18.292000000000002, 18.292999999999999, 18.292999999999999, 18.292999999999999, 18.289000000000001, 18.288, 18.280999999999999, 18.292999999999999, 18.288, 18.283000000000001, 18.295000000000002, 18.298999999999999, 18.292000000000002, 18.295000000000002, 18.285, 18.280999999999999, 18.274000000000001, 18.277000000000001, 18.286000000000001, 18.280999999999999, 18.280999999999999, 18.271999999999998, 18.265999999999998, 18.271999999999998, 18.27, 18.280999999999999, 18.277000000000001, 18.279, 18.273, 18.274000000000001, 18.285, 18.257999999999999, 18.245000000000001, 18.225999999999999, 18.262, 18.204000000000001, 18.263000000000002, 18.268999999999998, 18.190999999999999, 18.244, 18.274999999999999, 18.266999999999999, 18.222000000000001, 18.256], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [2452459.8185729999, 2452459.8306928999, 2452459.8427537, 2452459.8544839998, 2452459.8662323998, 2452459.8781472002, 2452459.8905604999, 2452459.9265550999, 2452459.9396608002, 2452459.9516302999, 2452459.9678898002, 2452460.8359277998, 2452460.8477614, 2452460.8590332, 2452460.8703704001, 2452460.8797658002, 2452460.8860125998, 2452460.8917079, 2452460.8995465999, 2452460.9050044999, 2452460.9105374999, 2452460.9163111001, 2452460.9222672, 2452460.9278273, 2452460.9348979001, 2452460.9403670998, 2452460.9458375, 2452460.9512713999, 2452460.9602051, 2452460.9680122002, 2452460.9772978001, 2452460.9963249001, 2452461.0041336999, 2452461.0139990998, 2452461.0205548001, 2452461.0263260999, 2452461.9460944999, 2452461.9544901, 2452461.9657820002, 2452461.9771384001, 2452462.0229802001, 2452462.0342620001, 2452462.0464984002, 2452462.0577341001, 2452462.0710685998, 2452462.7607836002, 2452462.7688618, 2452462.7769002998, 2452462.7858614, 2452462.7946760999, 2452462.8035118999, 2452462.8123579999, 2452462.8214123002, 2452462.8306542998, 2452462.8394995001, 2452462.8483488001, 2452462.8572032, 2452462.8660523999, 2452462.8749082, 2452462.8823346002, 2452462.8909723, 2452462.8986641001, 2452462.9063515002, 2452462.9140376998, 2452462.9217332001, 2452462.9311672999, 2452462.9404271999, 2452462.9517728998, 2452462.9629454999, 2452462.9741060999, 2452462.985289, 2452462.9995295, 2452463.0106823002, 2452463.0311850002, 2452463.0423504999, 2452463.0535200001, 2452463.0646822001, 2452463.0758628999, 2452463.8809282002, 2452463.8874500999, 2452463.8939705002, 2452463.9005070999, 2452463.9076045998, 2452463.9169577998, 2452463.9235367998, 2452463.930067, 2452463.9366052002, 2452463.9431272, 2452463.9496708, 2452463.9551916001, 2452463.9602402998, 2452463.9663979001, 2452463.9775524, 2452463.9887224999, 2452463.9998951, 2452464.011163, 2452464.0223873998, 2452464.0421890002, 2452464.0533674001, 2452464.0645380002, 2452464.0756991999, 2452464.0870150002, 2452464.0988989999, 2452464.7691935999, 2452464.7749973, 2452464.7831241, 2452464.7909835, 2452464.8000174998, 2452464.8076944002, 2452464.8153761998, 2452464.8230610001, 2452464.8307369002, 2452464.8386871, 2452464.8452079999, 2452464.8517354, 2452464.8582680998, 2452464.8655905002, 2452464.8767594001, 2452464.8879149002, 2452464.8995468002, 2452464.9130450999, 2452464.9231516002, 2452464.9296871, 2452464.9362169001, 2452464.9427677002, 2452464.9493045001, 2452464.9561382001, 2452464.9626708999, 2452464.9696414, 2452464.9756021001, 2452464.981557, 2452464.9875154002, 2452464.9934634999, 2452464.9994254, 2452465.0054914001, 2452465.0140225999, 2452465.0217162999, 2452465.0294037, 2452465.037087, 2452465.0447783, 2452465.0524713001, 2452465.0601661, 2452465.0681055002, 2452465.0758051001, 2452465.0835020002, 2452465.0911890999, 2452465.0988873001, 2452465.1065902999, 2452465.1151891998, 2452467.7593765999, 2452467.7668599999, 2452467.7762775002, 2452467.7855707998, 2452467.8086043, 2452467.8169767, 2452467.825799, 2452467.8346365001, 2452467.8434843002, 2452467.8523328002, 2452467.8618055, 2452467.8708151998, 2452467.8796521001, 2452467.8884855001, 2452467.8973221001, 2452467.9061568002, 2452467.9149984, 2452467.9418004998, 2452467.9506409001, 2452467.9704935998, 2452467.9904594002, 2452468.0012963, 2452468.0105833998, 2452468.0194202, 2452468.0282562999, 2452468.0375349, 2452468.0452104001, 2452468.0528988, 2452468.0605712999, 2452468.0682568001, 2452468.0759379002, 2452468.0836236998, 2452468.0913022002, 2452468.0989836999, 2452468.1067774999, 2452468.7639945, 2452468.7691489002, 2452468.7759491, 2452468.7836175999, 2452468.7912977999, 2452468.7973225, 2452468.8032638002, 2452468.8092083, 2452468.8151540998, 2452468.8215724002, 2452468.8269324, 2452468.8322859001, 2452468.8378158999, 2452468.847902, 2452468.8532652999, 2452468.8586452999, 2452468.8639948, 2452468.8693388999, 2452468.8747039, 2452468.8790183002, 2452468.8841531002, 2452468.889523, 2452468.8948754999, 2452468.9002418998, 2452468.9056131002, 2452468.9109888002, 2452468.9167252001, 2452468.9216781999, 2452468.9264699998, 2452468.9314191998, 2452468.9405119, 2452468.9446566999, 2452468.9518300998, 2452468.9554325999, 2452468.9590640999, 2452468.9626623001, 2452468.9668753999, 2452468.9716631998, 2452468.9764532, 2452468.9812404001, 2452468.9863103, 2452468.9912828999, 2452468.9960808, 2452469.0020086002, 2452469.0067834002, 2452469.0115621001, 2452469.0175521998, 2452469.0223194002, 2452469.0271128998, 2452469.0375691, 2452469.0413084002, 2452469.0465068999, 2452469.0530118998, 2452469.0595268002, 2452469.0660430999, 2452469.0725619998, 2452469.0795280999, 2452469.0860398998, 2452469.0925564999, 2452469.0997084999, 2452469.1062276, 2452469.1127443998], 'limitmags': {'lmt_mg': [], 't': []}}}}
                       },
                      {'xml_fpath':"$TCP_DIR/Software/feature_extract/Code/source_5.xml",
                       'expected_xsdict':{'src_id': 5, 'ra': 49.599485999999999, 'dec': -1.0051110000000001, 'dec_rms': 6.6000000000000005e-05, 'class': '', 'ra_rms': 0.000125, 'ts': {'g': {'ucds': [None, 'phot.mag;em.opt.g', 'stat.error;phot.mag;em.opt.g'], 'm_err': [0.107877, 0.109803, 0.106505, 0.082267000000000007, 0.083916000000000004, 0.098284999999999997, 0.10241400000000001, 0.087781999999999999, 0.128557, 0.14003699999999999, 0.114967, 0.127806, 0.11206000000000001, 0.25929099999999999, 0.12202, 0.078067999999999999, 0.126028, 0.25284699999999999, 0.14860899999999999, 0.236375, 0.18762499999999999, 0.114803, 0.101058, 0.10284699999999999, 0.101587, 0.26289899999999999, 0.086217000000000002, 0.14508599999999999, 0.145704, 0.18834400000000001, 0.18834500000000001, 0.43792700000000001, 0.112867, 0.187559], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [20.890499999999999, 20.697399999999998, 20.800000000000001, 20.7181, 20.808499999999999, 20.822600000000001, 20.830100000000002, 20.793500000000002, 20.763100000000001, 20.776199999999999, 20.8673, 20.8611, 20.836400000000001, 21.3705, 20.833600000000001, 20.8017, 20.769300000000001, 20.881699999999999, 20.887899999999998, 21.330300000000001, 20.8858, 20.672799999999999, 20.826699999999999, 20.853100000000001, 20.849699999999999, 20.702200000000001, 20.810099999999998, 20.602499999999999, 20.589600000000001, 20.875499999999999, 20.879899999999999, 20.6403, 20.835699999999999, 20.845500000000001], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [53270.413827999997, 53272.463797999997, 53286.432518000001, 53288.391012, 53294.438684000001, 53296.385667000002, 53296.385668000003, 53298.435461000001, 53302.386681999997, 53312.342191999996, 53314.343411000002, 53319.331209999997, 53616.447762999996, 53635.417441999998, 53639.456052000001, 53644.403098000003, 53657.414102000002, 53663.398650000003, 53665.376622999996, 53668.388251999997, 53669.475860999999, 53670.393103000002, 53673.361090999999, 53673.361091999999, 53675.357978, 53676.477628000001, 53680.365676000001, 53683.424226000003, 53683.424227000003, 53686.365106999998, 53686.365106999998, 53687.422490999998, 53704.350887000001, 53989.446909999999], 'limitmags': {'lmt_mg': [], 't': []}}, 'i': {'ucds': [None, 'phot.mag;em.opt.i', 'stat.error;phot.mag;em.opt.i'], 'm_err': [0.041328999999999998, 0.046803999999999998, 0.032253999999999998, 0.051715999999999998, 0.040918999999999997, 0.044320999999999999, 0.041375000000000002, 0.042116000000000001, 0.030654000000000001, 0.034576000000000003, 0.056406999999999999, 0.046264, 0.040835999999999997, 0.040259000000000003, 0.043643000000000001, 0.034638000000000002, 0.049311000000000001, 0.031593999999999997, 0.058742999999999997, 0.043118999999999998, 0.041188000000000002, 0.036046000000000002, 0.041369999999999997, 0.057846000000000002, 0.030485999999999999, 0.063372999999999999, 0.053413000000000002, 0.047262999999999999, 0.044193000000000003, 0.044801000000000001, 0.044801000000000001, 0.047445000000000001, 0.033465000000000002, 0.034296], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [17.685700000000001, 17.6663, 17.712299999999999, 17.686699999999998, 17.722899999999999, 17.693100000000001, 17.741099999999999, 17.688400000000001, 17.6843, 17.689900000000002, 17.693100000000001, 17.681000000000001, 17.688199999999998, 18.045400000000001, 17.6447, 17.6586, 17.695900000000002, 17.665900000000001, 17.6769, 18.101800000000001, 17.686, 17.6645, 17.683499999999999, 17.689699999999998, 17.695, 17.6952, 17.6859, 17.734000000000002, 17.661999999999999, 17.7012, 17.7014, 17.643999999999998, 17.674900000000001, 17.653099999999998], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [53270.411340999999, 53272.461310999999, 53286.430030000003, 53288.388524000002, 53294.436197000003, 53296.383178999997, 53296.383179999997, 53298.432973000003, 53302.384193999998, 53312.339703999998, 53314.340923000003, 53319.328721999998, 53616.445274999998, 53635.414954, 53639.453564000003, 53644.400610999997, 53657.411613999997, 53663.396162999998, 53665.374134999998, 53668.385764999999, 53669.473373000001, 53670.390615999997, 53673.358603000001, 53673.358604000001, 53675.355491000002, 53676.475141000003, 53680.363189000003, 53683.421738999998, 53683.421738999998, 53686.36262, 53686.36262, 53687.420002999999, 53704.348399000002, 53989.444422], 'limitmags': {'lmt_mg': [], 't': []}}, 'r': {'ucds': [None, 'phot.mag;em.opt.r', 'stat.error;phot.mag;em.opt.r'], 'm_err': [0.038968999999999997, 0.055625000000000001, 0.038094000000000003, 0.040437000000000001, 0.052701999999999999, 0.047205999999999998, 0.059880999999999997, 0.044873000000000003, 0.047807000000000002, 0.049522999999999998, 0.046754999999999998, 0.045263999999999999, 0.045162000000000001, 0.059270000000000003, 0.040321999999999997, 0.043672999999999997, 0.050465000000000003, 0.068624000000000004, 0.046510000000000003, 0.066961000000000007, 0.060262999999999997, 0.076813000000000006, 0.045211000000000001, 0.042854999999999997, 0.046378999999999997, 0.13069500000000001, 0.042118999999999997, 0.075298000000000004, 0.075562000000000004, 0.057834999999999998, 0.057799000000000003, 0.15165300000000001, 0.057007000000000002, 0.051049999999999998], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [19.250699999999998, 19.248200000000001, 19.286100000000001, 19.279499999999999, 19.3292, 19.336400000000001, 19.314699999999998, 19.258400000000002, 19.252600000000001, 19.254300000000001, 19.2623, 19.338100000000001, 19.2776, 19.5885, 19.289000000000001, 19.276199999999999, 19.229099999999999, 19.2804, 19.314900000000002, 19.733499999999999, 19.275099999999998, 19.263999999999999, 19.1723, 19.2684, 19.320699999999999, 19.322399999999998, 19.2532, 19.166799999999999, 19.2456, 19.274999999999999, 19.273599999999998, 19.342600000000001, 19.253799999999998, 19.2501], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [53270.410511000002, 53272.460481000002, 53286.429200999999, 53288.387694999998, 53294.435366999998, 53296.38235, 53296.382351, 53298.432143999999, 53302.383365000002, 53312.338875000001, 53314.340093999999, 53319.327893000001, 53616.444446000001, 53635.414125000003, 53639.452734999999, 53644.399781, 53657.410785, 53663.395333, 53665.373306000001, 53668.384935000002, 53669.472543999997, 53670.389786, 53673.357773999996, 53673.357774999997, 53675.354660999998, 53676.474310999998, 53680.362358999999, 53683.420909, 53683.420910000001, 53686.361790000003, 53686.361790000003, 53687.419173000002, 53704.347569999998, 53989.443593000004], 'limitmags': {'lmt_mg': [], 't': []}}, 'u': {'ucds': [None, 'phot.mag;em.opt.u', 'stat.error;phot.mag;em.opt.u'], 'm_err': [1.1430199999999999, 0.93818699999999999, 3.0487099999999998, 1.32318, 1.6772100000000001, 2.3523700000000001, 2.6355900000000001, 4.9840900000000001, 4.0011299999999999, 1.4847600000000001, 5.0745300000000002, 1.96343, 1.4783900000000001, 1.1473199999999999, 1.75064, 0.65199399999999996, 2.4556800000000001, 1.3030600000000001, 1.05287, 0.96933400000000003, 1.9274500000000001, 4.8445499999999999, 2.8658299999999999, 3.73814, 2.43391], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [23.2498, 22.685099999999998, 23.559799999999999, 23.1465, 23.153500000000001, 23.581800000000001, 23.494299999999999, 24.625499999999999, 24.039899999999999, 22.5947, 24.3172, 23.250800000000002, 22.854099999999999, 23.184799999999999, 22.784300000000002, 21.779499999999999, 23.027699999999999, 21.949300000000001, 22.9054, 22.828900000000001, 23.433399999999999, 22.614100000000001, 24.0609, 22.4633, 23.284500000000001], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [53270.412170000003, 53272.462140000003, 53286.43086, 53288.389353999999, 53294.437026, 53296.384008000001, 53296.384010000002, 53298.433803, 53302.385023000003, 53312.340534000003, 53314.341753000001, 53616.446104000002, 53639.454393, 53644.401440000001, 53657.412443000001, 53665.374964000002, 53668.386594000003, 53669.474201999998, 53673.359431999997, 53673.359432999998, 53675.356319999999, 53676.47597, 53680.364018, 53687.420832000003, 53704.349228999999], 'limitmags': {'lmt_mg': [], 't': []}}, 'z': {'ucds': [None, 'phot.mag;em.opt.z', 'stat.error;phot.mag;em.opt.z'], 'm_err': [0.027765999999999999, 0.049897999999999998, 0.040585000000000003, 0.063133999999999996, 0.050145000000000002, 0.049485000000000001, 0.052167999999999999, 0.033707000000000001, 0.038330999999999997, 0.037141, 0.033297, 0.050019000000000001, 0.051908000000000003, 0.043513000000000003, 0.033824, 0.030515, 0.043399, 0.033883999999999997, 0.033699, 0.053305999999999999, 0.041048000000000001, 0.053379000000000003, 0.046922999999999999, 0.056217999999999997, 0.051289000000000001, 0.070140999999999995, 0.033354000000000002, 0.049550999999999998, 0.045811999999999999, 0.032167000000000001, 0.032169000000000003, 0.117574, 0.041088, 0.042455], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [16.8002, 16.791399999999999, 16.8202, 16.799900000000001, 16.7544, 16.838100000000001, 16.831800000000001, 16.8186, 16.799800000000001, 16.813500000000001, 16.7897, 16.8218, 16.832699999999999, 17.212, 16.7852, 16.811699999999998, 16.824100000000001, 16.832000000000001, 16.8001, 17.245000000000001, 16.821999999999999, 16.803000000000001, 16.7776, 16.7912, 16.819600000000001, 16.779900000000001, 16.8217, 16.7517, 16.764500000000002, 16.804200000000002, 16.804500000000001, 16.835999999999999, 16.802800000000001, 16.779800000000002], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [53270.412999, 53272.462969, 53286.431688999997, 53288.390183000003, 53294.437854999996, 53296.384837999998, 53296.384838999998, 53298.434631999997, 53302.385853, 53312.341363, 53314.342581999997, 53319.330381, 53616.446934, 53635.416612000001, 53639.455222999997, 53644.402268999998, 53657.413272999998, 53663.397820999999, 53665.375794, 53668.387423, 53669.475032000002, 53670.392273999998, 53673.360262000002, 53673.360263000002, 53675.357149000003, 53676.476798999996, 53680.364846999997, 53683.423396999999, 53683.423397999999, 53686.364278000001, 53686.364278000001, 53687.421661, 53704.350058000004, 53989.446081000002], 'limitmags': {'lmt_mg': [], 't': []}}, 'combo_band': {'ucds': [None, 'phot.mag;em.opt.i', 'stat.error;phot.mag;em.opt.i'], 'm_err': [0.038968999999999997, 0.041328999999999998, 1.1430199999999999, 0.027765999999999999, 0.107877, 0.055625000000000001, 0.046803999999999998, 0.93818699999999999, 0.049897999999999998, 0.109803, 0.038094000000000003, 0.032253999999999998, 3.0487099999999998, 0.040585000000000003, 0.106505, 0.040437000000000001, 0.051715999999999998, 1.32318, 0.063133999999999996, 0.082267000000000007, 0.052701999999999999, 0.040918999999999997, 1.6772100000000001, 0.050145000000000002, 0.083916000000000004, 0.047205999999999998, 0.059880999999999997, 0.044320999999999999, 0.041375000000000002, 2.3523700000000001, 2.6355900000000001, 0.049485000000000001, 0.052167999999999999, 0.098284999999999997, 0.10241400000000001, 0.044873000000000003, 0.042116000000000001, 4.9840900000000001, 0.033707000000000001, 0.087781999999999999, 0.047807000000000002, 0.030654000000000001, 4.0011299999999999, 0.038330999999999997, 0.128557, 0.049522999999999998, 0.034576000000000003, 1.4847600000000001, 0.037141, 0.14003699999999999, 0.046754999999999998, 0.056406999999999999, 5.0745300000000002, 0.033297, 0.114967, 0.045263999999999999, 0.046264, 0.050019000000000001, 0.127806, 0.045162000000000001, 0.040835999999999997, 1.96343, 0.051908000000000003, 0.11206000000000001, 0.059270000000000003, 0.040259000000000003, 0.043513000000000003, 0.25929099999999999, 0.040321999999999997, 0.043643000000000001, 1.4783900000000001, 0.033824, 0.12202, 0.043672999999999997, 0.034638000000000002, 1.1473199999999999, 0.030515, 0.078067999999999999, 0.050465000000000003, 0.049311000000000001, 1.75064, 0.043399, 0.126028, 0.068624000000000004, 0.031593999999999997, 0.033883999999999997, 0.25284699999999999, 0.046510000000000003, 0.058742999999999997, 0.65199399999999996, 0.033699, 0.14860899999999999, 0.066961000000000007, 0.043118999999999998, 2.4556800000000001, 0.053305999999999999, 0.236375, 0.060262999999999997, 0.041188000000000002, 1.3030600000000001, 0.041048000000000001, 0.18762499999999999, 0.076813000000000006, 0.036046000000000002, 0.053379000000000003, 0.114803, 0.045211000000000001, 0.042854999999999997, 0.041369999999999997, 0.057846000000000002, 1.05287, 0.96933400000000003, 0.046922999999999999, 0.056217999999999997, 0.101058, 0.10284699999999999, 0.046378999999999997, 0.030485999999999999, 1.9274500000000001, 0.051289000000000001, 0.101587, 0.13069500000000001, 0.063372999999999999, 4.8445499999999999, 0.070140999999999995, 0.26289899999999999, 0.042118999999999997, 0.053413000000000002, 2.8658299999999999, 0.033354000000000002, 0.086217000000000002, 0.075298000000000004, 0.075562000000000004, 0.047262999999999999, 0.044193000000000003, 0.049550999999999998, 0.045811999999999999, 0.14508599999999999, 0.145704, 0.057834999999999998, 0.057799000000000003, 0.044801000000000001, 0.044801000000000001, 0.032167000000000001, 0.032169000000000003, 0.18834400000000001, 0.18834500000000001, 0.15165300000000001, 0.047445000000000001, 3.73814, 0.117574, 0.43792700000000001, 0.057007000000000002, 0.033465000000000002, 2.43391, 0.041088, 0.112867, 0.051049999999999998, 0.034296, 0.042455, 0.187559], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [19.250699999999998, 17.685700000000001, 23.2498, 16.8002, 20.890499999999999, 19.248200000000001, 17.6663, 22.685099999999998, 16.791399999999999, 20.697399999999998, 19.286100000000001, 17.712299999999999, 23.559799999999999, 16.8202, 20.800000000000001, 19.279499999999999, 17.686699999999998, 23.1465, 16.799900000000001, 20.7181, 19.3292, 17.722899999999999, 23.153500000000001, 16.7544, 20.808499999999999, 19.336400000000001, 19.314699999999998, 17.693100000000001, 17.741099999999999, 23.581800000000001, 23.494299999999999, 16.838100000000001, 16.831800000000001, 20.822600000000001, 20.830100000000002, 19.258400000000002, 17.688400000000001, 24.625499999999999, 16.8186, 20.793500000000002, 19.252600000000001, 17.6843, 24.039899999999999, 16.799800000000001, 20.763100000000001, 19.254300000000001, 17.689900000000002, 22.5947, 16.813500000000001, 20.776199999999999, 19.2623, 17.693100000000001, 24.3172, 16.7897, 20.8673, 19.338100000000001, 17.681000000000001, 16.8218, 20.8611, 19.2776, 17.688199999999998, 23.250800000000002, 16.832699999999999, 20.836400000000001, 19.5885, 18.045400000000001, 17.212, 21.3705, 19.289000000000001, 17.6447, 22.854099999999999, 16.7852, 20.833600000000001, 19.276199999999999, 17.6586, 23.184799999999999, 16.811699999999998, 20.8017, 19.229099999999999, 17.695900000000002, 22.784300000000002, 16.824100000000001, 20.769300000000001, 19.2804, 17.665900000000001, 16.832000000000001, 20.881699999999999, 19.314900000000002, 17.6769, 21.779499999999999, 16.8001, 20.887899999999998, 19.733499999999999, 18.101800000000001, 23.027699999999999, 17.245000000000001, 21.330300000000001, 19.275099999999998, 17.686, 21.949300000000001, 16.821999999999999, 20.8858, 19.263999999999999, 17.6645, 16.803000000000001, 20.672799999999999, 19.1723, 19.2684, 17.683499999999999, 17.689699999999998, 22.9054, 22.828900000000001, 16.7776, 16.7912, 20.826699999999999, 20.853100000000001, 19.320699999999999, 17.695, 23.433399999999999, 16.819600000000001, 20.849699999999999, 19.322399999999998, 17.6952, 22.614100000000001, 16.779900000000001, 20.702200000000001, 19.2532, 17.6859, 24.0609, 16.8217, 20.810099999999998, 19.166799999999999, 19.2456, 17.734000000000002, 17.661999999999999, 16.7517, 16.764500000000002, 20.602499999999999, 20.589600000000001, 19.274999999999999, 19.273599999999998, 17.7012, 17.7014, 16.804200000000002, 16.804500000000001, 20.875499999999999, 20.879899999999999, 19.342600000000001, 17.643999999999998, 22.4633, 16.835999999999999, 20.6403, 19.253799999999998, 17.674900000000001, 23.284500000000001, 16.802800000000001, 20.835699999999999, 19.2501, 17.653099999999998, 16.779800000000002, 20.845500000000001], 'IDs': ['col1', 'col2', 'col3'], 'limitmags': {'lmt_mg': [], 't': []}, 't': [53270.410511000002, 53270.411340999999, 53270.412170000003, 53270.412999, 53270.413827999997, 53272.460481000002, 53272.461310999999, 53272.462140000003, 53272.462969, 53272.463797999997, 53286.429200999999, 53286.430030000003, 53286.43086, 53286.431688999997, 53286.432518000001, 53288.387694999998, 53288.388524000002, 53288.389353999999, 53288.390183000003, 53288.391012, 53294.435366999998, 53294.436197000003, 53294.437026, 53294.437854999996, 53294.438684000001, 53296.38235, 53296.382351, 53296.383178999997, 53296.383179999997, 53296.384008000001, 53296.384010000002, 53296.384837999998, 53296.384838999998, 53296.385667000002, 53296.385668000003, 53298.432143999999, 53298.432973000003, 53298.433803, 53298.434631999997, 53298.435461000001, 53302.383365000002, 53302.384193999998, 53302.385023000003, 53302.385853, 53302.386681999997, 53312.338875000001, 53312.339703999998, 53312.340534000003, 53312.341363, 53312.342191999996, 53314.340093999999, 53314.340923000003, 53314.341753000001, 53314.342581999997, 53314.343411000002, 53319.327893000001, 53319.328721999998, 53319.330381, 53319.331209999997, 53616.444446000001, 53616.445274999998, 53616.446104000002, 53616.446934, 53616.447762999996, 53635.414125000003, 53635.414954, 53635.416612000001, 53635.417441999998, 53639.452734999999, 53639.453564000003, 53639.454393, 53639.455222999997, 53639.456052000001, 53644.399781, 53644.400610999997, 53644.401440000001, 53644.402268999998, 53644.403098000003, 53657.410785, 53657.411613999997, 53657.412443000001, 53657.413272999998, 53657.414102000002, 53663.395333, 53663.396162999998, 53663.397820999999, 53663.398650000003, 53665.373306000001, 53665.374134999998, 53665.374964000002, 53665.375794, 53665.376622999996, 53668.384935000002, 53668.385764999999, 53668.386594000003, 53668.387423, 53668.388251999997, 53669.472543999997, 53669.473373000001, 53669.474201999998, 53669.475032000002, 53669.475860999999, 53670.389786, 53670.390615999997, 53670.392273999998, 53670.393103000002, 53673.357773999996, 53673.357774999997, 53673.358603000001, 53673.358604000001, 53673.359431999997, 53673.359432999998, 53673.360262000002, 53673.360263000002, 53673.361090999999, 53673.361091999999, 53675.354660999998, 53675.355491000002, 53675.356319999999, 53675.357149000003, 53675.357978, 53676.474310999998, 53676.475141000003, 53676.47597, 53676.476798999996, 53676.477628000001, 53680.362358999999, 53680.363189000003, 53680.364018, 53680.364846999997, 53680.365676000001, 53683.420909, 53683.420910000001, 53683.421738999998, 53683.421738999998, 53683.423396999999, 53683.423397999999, 53683.424226000003, 53683.424227000003, 53686.361790000003, 53686.361790000003, 53686.36262, 53686.36262, 53686.364278000001, 53686.364278000001, 53686.365106999998, 53686.365106999998, 53687.419173000002, 53687.420002999999, 53687.420832000003, 53687.421661, 53687.422490999998, 53704.347569999998, 53704.348399000002, 53704.349228999999, 53704.350058000004, 53704.350887000001, 53989.443593000004, 53989.444422, 53989.446081000002, 53989.446909999999], 'units': ['day', 'mag', 'mag']}}}},
                      {'xml_fpath':"$TCP_DIR/Data/vosource_tutor12881.xml",
                       'expected_xsdict':{'src_id': 12881, 'ra': 30.475677300000001, 'dec': -8.3583666999999995, 'dec_rms': 0.0, 'class': 'RR Lyrae, Fundamental Mode', 'ra_rms': 0.0, 'ts': {'H:table1384': {'ucds': [None, 'phot.mag;em.opt.H:table1384', 'stat.error;phot.mag;em.opt.H:table1384'], 'm_err': [0.042999999999999997, 0.043999999999999997, 0.041000000000000002, 0.042999999999999997, 0.057000000000000002, 0.043999999999999997, 0.041000000000000002, 0.052999999999999999, 0.049000000000000002, 0.052999999999999999, 0.043999999999999997, 0.044999999999999998, 0.052999999999999999, 0.044999999999999998, 0.042999999999999997, 0.044999999999999998, 0.042000000000000003, 0.042999999999999997, 0.042999999999999997, 0.044999999999999998, 0.042999999999999997, 0.049000000000000002, 0.050000000000000003, 0.047, 0.043999999999999997, 0.052999999999999999, 0.042999999999999997, 0.049000000000000002, 0.048000000000000001, 0.044999999999999998, 0.040000000000000001, 0.045999999999999999, 0.043999999999999997, 0.042999999999999997, 0.052999999999999999, 0.039, 0.040000000000000001, 0.043999999999999997, 0.050999999999999997, 0.047, 0.047, 0.041000000000000002, 0.045999999999999999, 0.056000000000000001, 0.042999999999999997, 0.041000000000000002, 0.058000000000000003, 0.051999999999999998, 0.049000000000000002, 0.057000000000000002, 0.094, 0.064000000000000001, 0.045999999999999999, 0.070000000000000007, 0.042000000000000003, 0.039, 0.043999999999999997, 0.043999999999999997, 0.058000000000000003, 0.052999999999999999, 0.058999999999999997, 0.050000000000000003, 0.051999999999999998, 0.063, 0.040000000000000001], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [11.3088, 11.3088, 11.5783, 12.305300000000001, 12.321, 11.668699999999999, 11.9244, 12.0059, 12.189, 12.235300000000001, 11.9657, 11.7082, 12.236599999999999, 12.2394, 12.2447, 11.7028, 11.4518, 11.5181, 11.631, 11.927899999999999, 11.628, 11.821099999999999, 11.900399999999999, 12.059799999999999, 12.1152, 11.8817, 12.0547, 12.071199999999999, 11.3024, 11.758800000000001, 11.815099999999999, 12.1075, 12.261200000000001, 12.038600000000001, 12.051399999999999, 11.345000000000001, 11.3621, 11.7516, 11.768000000000001, 11.3727, 11.5512, 11.612299999999999, 11.9415, 12.043799999999999, 11.426399999999999, 11.485300000000001, 11.9278, 11.964499999999999, 12.110099999999999, 12.1281, 12.1953, 12.2706, 12.2646, 12.2948, 11.3249, 11.2539, 11.681900000000001, 11.7258, 12.307499999999999, 12.204800000000001, 12.264200000000001, 12.3428, 12.2278, 12.552199999999999, 12.2401], 'IDs': ['col1', 'col2', 'col3'], 'units': ['day', 'mag', 'mag'], 't': [7904.2075699999996, 7904.2218899999998, 7904.2964599999996, 7949.5192999999999, 7949.5336200000002, 8084.5430399999996, 8084.6176299999997, 8084.6319299999996, 8084.7065400000001, 8084.7208600000004, 8112.6981100000003, 8112.71245, 8133.7626099999998, 8133.7769600000001, 8133.8514999999998, 8250.8936200000007, 8250.9079600000005, 8250.9825199999996, 8250.9968499999995, 8251.0713899999992, 8297.4656200000009, 8430.7776200000008, 8430.7919700000002, 8430.8665199999996, 8430.8808800000006, 8450.6998999999996, 8450.7744600000005, 8450.7887599999995, 8479.6683499999999, 8599.7534500000002, 8599.7677700000004, 8599.8566200000005, 8599.9455099999996, 8612.1070799999998, 8612.1214500000006, 8644.0896699999994, 8644.1040200000007, 8644.1785799999998, 8644.1928700000008, 8677.7716400000008, 8677.8461599999991, 8677.8604799999994, 8677.9350400000003, 8677.9493600000005, 8687.5335300000006, 8687.5478700000003, 8687.6224399999992, 8687.6367300000002, 8687.7113000000008, 8687.7256400000006, 8779.7263700000003, 8779.7406900000005, 8779.8152399999999, 8779.8295400000006, 8779.9041400000006, 8779.9184600000008, 8779.9930299999996, 8780.0073799999991, 8780.1707999999999, 8787.81538, 8787.8297199999997, 8787.9042900000004, 8787.9186100000006, 8787.9931899999992, 8825.0927300000003], 'limitmags': {'lmt_mg': [], 't': []}}, 'combo_band': {'ucds': [None, 'phot.mag;em.opt.H:table1384', 'stat.error;phot.mag;em.opt.H:table1384'], 'm_err': [0.042999999999999997, 0.043999999999999997, 0.041000000000000002, 0.042999999999999997, 0.057000000000000002, 0.043999999999999997, 0.041000000000000002, 0.052999999999999999, 0.049000000000000002, 0.052999999999999999, 0.043999999999999997, 0.044999999999999998, 0.052999999999999999, 0.044999999999999998, 0.042999999999999997, 0.044999999999999998, 0.042000000000000003, 0.042999999999999997, 0.042999999999999997, 0.044999999999999998, 0.042999999999999997, 0.049000000000000002, 0.050000000000000003, 0.047, 0.043999999999999997, 0.052999999999999999, 0.042999999999999997, 0.049000000000000002, 0.048000000000000001, 0.044999999999999998, 0.040000000000000001, 0.045999999999999999, 0.043999999999999997, 0.042999999999999997, 0.052999999999999999, 0.039, 0.040000000000000001, 0.043999999999999997, 0.050999999999999997, 0.047, 0.047, 0.041000000000000002, 0.045999999999999999, 0.056000000000000001, 0.042999999999999997, 0.041000000000000002, 0.058000000000000003, 0.051999999999999998, 0.049000000000000002, 0.057000000000000002, 0.094, 0.064000000000000001, 0.045999999999999999, 0.070000000000000007, 0.042000000000000003, 0.039, 0.043999999999999997, 0.043999999999999997, 0.058000000000000003, 0.052999999999999999, 0.058999999999999997, 0.050000000000000003, 0.051999999999999998, 0.063, 0.040000000000000001], 'ordered_column_names': ['t', 'm', 'm_err'], 'm': [11.3088, 11.3088, 11.5783, 12.305300000000001, 12.321, 11.668699999999999, 11.9244, 12.0059, 12.189, 12.235300000000001, 11.9657, 11.7082, 12.236599999999999, 12.2394, 12.2447, 11.7028, 11.4518, 11.5181, 11.631, 11.927899999999999, 11.628, 11.821099999999999, 11.900399999999999, 12.059799999999999, 12.1152, 11.8817, 12.0547, 12.071199999999999, 11.3024, 11.758800000000001, 11.815099999999999, 12.1075, 12.261200000000001, 12.038600000000001, 12.051399999999999, 11.345000000000001, 11.3621, 11.7516, 11.768000000000001, 11.3727, 11.5512, 11.612299999999999, 11.9415, 12.043799999999999, 11.426399999999999, 11.485300000000001, 11.9278, 11.964499999999999, 12.110099999999999, 12.1281, 12.1953, 12.2706, 12.2646, 12.2948, 11.3249, 11.2539, 11.681900000000001, 11.7258, 12.307499999999999, 12.204800000000001, 12.264200000000001, 12.3428, 12.2278, 12.552199999999999, 12.2401], 'IDs': ['col1', 'col2', 'col3'], 'limitmags': {'lmt_mg': [], 't': []}, 't': [7904.2075699999996, 7904.2218899999998, 7904.2964599999996, 7949.5192999999999, 7949.5336200000002, 8084.5430399999996, 8084.6176299999997, 8084.6319299999996, 8084.7065400000001, 8084.7208600000004, 8112.6981100000003, 8112.71245, 8133.7626099999998, 8133.7769600000001, 8133.8514999999998, 8250.8936200000007, 8250.9079600000005, 8250.9825199999996, 8250.9968499999995, 8251.0713899999992, 8297.4656200000009, 8430.7776200000008, 8430.7919700000002, 8430.8665199999996, 8430.8808800000006, 8450.6998999999996, 8450.7744600000005, 8450.7887599999995, 8479.6683499999999, 8599.7534500000002, 8599.7677700000004, 8599.8566200000005, 8599.9455099999996, 8612.1070799999998, 8612.1214500000006, 8644.0896699999994, 8644.1040200000007, 8644.1785799999998, 8644.1928700000008, 8677.7716400000008, 8677.8461599999991, 8677.8604799999994, 8677.9350400000003, 8677.9493600000005, 8687.5335300000006, 8687.5478700000003, 8687.6224399999992, 8687.6367300000002, 8687.7113000000008, 8687.7256400000006, 8779.7263700000003, 8779.7406900000005, 8779.8152399999999, 8779.8295400000006, 8779.9041400000006, 8779.9184600000008, 8779.9930299999996, 8780.0073799999991, 8780.1707999999999, 8787.81538, 8787.8297199999997, 8787.9042900000004, 8787.9186100000006, 8787.9931899999992, 8825.0927300000003], 'units': ['day', 'mag', 'mag']}}}},

                      ],
        }



def IntersectDicts( d1, d2 ) :
    """
    Reference: http://stackoverflow.com/questions/314583/comparing-multiple-dictionaries-in-python
    """
    return dict(filter(lambda (k,v) : k in d2 and d2[k] == v, d1.items()))

def nonIntersectDicts( d1, d2 ) :
    """ Given 2 dicts, find the keys where there are discrepancies or mis-matches.

    NOTE: d1 is the expected dictionary.

    NOTE: the lambda function works only when the comparizon dictionaries are populated with similar keys

    Reference: http://stackoverflow.com/questions/314583/comparing-multiple-dictionaries-in-python
    """

    mismatch = dict(filter(lambda (k,v) : k in d2 and d2[k] != v, d1.items()))
    if len(mismatch) > 0:
        return mismatch
    
    mismatch = {}
    for k in d1.keys():
        if k not in d2.keys():
            mismatch[k] = d1[k]

    return mismatch


class Test_Methods:
    """ Various testing cases
    """

    def __init__(self,pars):
        self.pars = pars


    def test_xmlread_using_example_files(self):
        """
        ##### This just tests that db_importer.Source() can read read various .xmls
        """
        for test_dict in self.pars['test_cases']:
            fpath = os.path.expandvars(test_dict['xml_fpath'])
            s = db_importer.Source(xml_handle=fpath)
            #pprint.pprint(s.x_sdict)
            #print s.x_sdict
            non_intersect_dict = nonIntersectDicts(test_dict['expected_xsdict'], s.x_sdict)
            if len(non_intersect_dict) > 0:
                print "(MISMATCH) x_sdict dictionary keys():", fpath, non_intersect_dict.keys()
            else:
                print "(PASS):   ", fpath

                
    def test_rw_oldxml_files_compare_xsdict(self):
        """
        ##### Read an old-xml, write it as old-xml, compare results:
        """
        orig_fpath = os.path.expandvars("$TCP_DIR/Data/vosource_9026.xml")
        s = db_importer.Source(xml_handle=orig_fpath)
        s.source_dict_to_xml(s.x_sdict) # this fills s.xml_string with old-xml style, and is needed before old-xml write()
        temp_fpath = '/tmp/test_db_importer.py__test.xml'
        if os.path.exists(temp_fpath):
            os.system("rm " + temp_fpath)
        s.write_xml(out_xml_fpath=temp_fpath)
                
        s_orig = db_importer.Source(xml_handle=orig_fpath)
        s_temp = db_importer.Source(xml_handle=temp_fpath)
        non_intersect_dict = nonIntersectDicts(s_orig.x_sdict, s_temp.x_sdict)
        non_intersect_dict_keys = non_intersect_dict.keys()
        non_intersect_dict_keys.remove('ts') # this just shows some float point accuracy errors
        if len(non_intersect_dict_keys) > 0:
            print "(MISMATCH) old-xml read/write and comparison. x_sdict dictionary keys():", fpath, non_intersect_dict.keys()
            pprint.pprint(s_orig.x_sdict['ts'])
            pprint.pprint(s_temp.x_sdict['ts'])
        else:
            print "(PASS):   old-xml read/write and comparison."


    def test_write_simpletimeseries_xml(self):
        """
        Given an oldxml fpath, parse and write as simpletimeseries xml, which is then written.
        """
        #orig_fpath = os.path.expandvars("$TCP_DIR/Data/vosource_9026.xml")
        #orig_fpath = os.path.expandvars("$HOME/scratch/simbad_classes_ptf_sources/out_xmls/09hry.xml")
        #orig_fpath = os.path.expandvars("$HOME/scratch/vosource_xml_writedir/100021293.xml")
        orig_fpath = os.path.expandvars("$TCP_DIR/Data/dotastro_21293.xml")
        s = db_importer.Source(xml_handle=orig_fpath)
        out_str = s.source_dict_to_xml__simptimeseries(s.x_sdict)
        temp_xml_fpath = "/tmp/blah.xml"
        fp = open(temp_xml_fpath, 'w')
        fp.write(out_str)
        fp.close()


        print #                    self.simpletimeseriesxml_to_source_dict(self.xml_handle)
        print
        print
        os.system("scp %s pteluser@lyra.berkeley.edu:public_html/tcp_xmls/" % (temp_xml_fpath))
        #os.system("cat %s" % (temp_xml_fpath))

        # This parses STSxml into sdict:
        s = db_importer.Source(xml_handle=temp_xml_fpath, read_simpletimeseries=True)
        # This converts new sdict into simpletimeseries xml string
        out_str = s.source_dict_to_xml__simptimeseries(s.x_sdict)
        temp_xml_fpath_2 = "/tmp/blah2.xml"
        fp = open(temp_xml_fpath_2, 'w')
        fp.write(out_str)
        fp.close()

        # TODO: do some test related to reading this simpletimeseries xml file.
        
        

    def main(self):
        """ Call all testing methods here.
        """
        self.test_xmlread_using_example_files()
        self.test_rw_oldxml_files_compare_xsdict()
        self.test_write_simpletimeseries_xml()

        
if __name__ == "__main__":

    # TODO: generate a simpletimeseries xml when given an old vosource.xml
    #  - 

    #fpath = os.path.expandvars("$TCP_DIR/Data/vosource_9026.xml")
    #s = db_importer.Source(xml_handle=fpath)


    TestMethods = Test_Methods(pars)
    TestMethods.main()

